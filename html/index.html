<!DOCTYPE html>
<html>
<head>
<title>VM Listing</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu+Mono">
<link rel="stylesheet" href="https://allenzfliu.com/css/allenzfliu.css">
<script type="text/javascript">
function api_fetch(id, p_class, url, headers) {
fetch(url).then(response => {
	if (!response.ok) {
		throw new Error(`HTTP error! Status: ${response.status}`);
	}
	return response.json();
}).then(response => {
	document.getElementById(id).innerHTML = list(response["vms"], p_class);
}).catch(err => {
	document.getElementById(id).innerHTML = "<p type=\"time_out\">ERROR: lgd-api is down!</p>" + 
		"<p>"+err+"</p>";
});
}
function list(vm_array, p_class) {
	try {
		out = "";
		for (var i = 0; i < vm_array.length; i++) {
			vm_name = vm_array[i]["name"];
			out += "<div class=\"" + p_class + "\"><p>" + 
				"<a href=\"/vm.html?name=" + vm_name + "\">" + 
				vm_name + "</a></p></div>";
		}
		return out;
	} catch (error) {
		return "Unable to process vm_array " + vm_array;
	}
}
</script>
<script type="text/javascript">
url = 'http://api.rhodes.island:8000/vms?type=active';
api_fetch("active_vms", "active_vm", url);
url = 'http://api.rhodes.island:8000/vms?type=inactive';
api_fetch("inactive_vms", "inactive_vm", url);
</script>
<style>
html {
	font-size: 24px;
}
/*.active_vm {
	color: #ff00aa;
}

.inactive_vm {
	color: #ff00aa;
}*/
</style>
</head>
<body>


<div class="row">
	<div class="column" style="background-color:#bfbbbb;">
	<p>Active VMs:</p>
	<div id="active_vms">Loading...</div>
	</div>
	<div class="column padding"></div>
	<div class="column" style="background-color:#aaafaf;">
	<p>Inactive VMs:</p>
	<div id="inactive_vms">Loading...</div>
	</div>
</div>

</body>
</html>
